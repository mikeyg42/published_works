<!DOCTYPE html>
<html>
<head>
    <title>WebSocket Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        button { margin: 5px; padding: 10px; }
        #output { margin-top: 20px; padding: 10px; border: 1px solid #ccc; }
    </style>
</head>
<body>
    <h2>WebSocket Test Page</h2>
    <button onclick="connect()">Connect</button>
    <button onclick="disconnect()">Disconnect</button>
    <button onclick="sendTestMessage()">Send Test Message</button>
    <button onclick="sendMazeSolverRequest()">Send Maze Solver Request</button>
    <div id="output"></div>

    <script>
        let ws = null;
        const output = document.getElementById('output');

        function log(message) {
            console.log(message);
            output.innerHTML += message + '<br>';
        }

        function connect() {
            if (ws) {
                log('Already connected');
                return;
            }

            log('Attempting to connect...');
            ws = new WebSocket('wss://127.0.0.1:8000/maze-solver');

            ws.onopen = () => {
                log('Connection established');
            };

            ws.onmessage = (event) => {
                log('Received: ' + event.data);
            };

            ws.onerror = (error) => {
                log('Error: ' + error);
            };

            ws.onclose = (event) => {
                log('Connection closed. Code: ' + event.code + ', Reason: ' + event.reason);
                ws = null;
            };
        }

        function disconnect() {
            if (ws) {
                ws.close();
                log('Disconnected');
            } else {
                log('Not connected');
            }
        }

        function sendTestMessage() {
            if (!ws) {
                log('Not connected');
                return;
            }
            ws.send('Hello Server!');
            log('Sent: Hello Server!');
        }

        function sendMazeSolverRequest() {
            if (!ws) {
                log('Not connected');
                return;
            }

            // Example maze solver request matching the backend's expected format
            const request = {
                largeComponents: [{
                    // Simple adjacency list format
                    "1": ["2", "3"],
                    "2": ["1", "4"],
                    "3": ["1", "4"],
                    "4": ["2", "3"]
                }],
                dimensions: {
                    width: 2,
                    height: 2
                }
            };

            try {
                const jsonString = JSON.stringify(request);
                log('Sending request: ' + jsonString);
                ws.send(jsonString);
            } catch (error) {
                log('Error sending request: ' + error.message);
            }
        }
    </script>
</body>
</html> 